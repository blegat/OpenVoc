<% provide(:title, 'List') %>
<h1><%= @path %></h1>


<div class="row">
  <div class="col-md-12">
    <div class="btn-group">
      <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#">
        Action <i class="glyphicon-cog"></i>
        <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
        <% unless @list.nil? %>
          <li>
          <% if @list.parent.nil? %>
            <%= link_to "Go back to /", lists_path %>
          <% else %>
            <%= link_to "Go back to #{@list.parent.path}", @list.parent %>
          <% end %>
          </li>
          <% unless @moving %>
            <li>
            <%= link_to "Move", list_moving_path(@list) %>
            </li>
          <% end %>
          <li>
          <%= link_to "Export", list_export_path(@list) %>
          </li>
					<li> 
					<%= link_to "Delete list", @list, method: :delete, data: {confirm: "You sure?"} %>
					</li>
        <% end %>
        <% if @new_list.nil? %>
          <li>
          <%= link_to 'New list here', path_for_new_list(@list) %>
          </li>
        <% end %>
				
      </ul>
    </div>

    <% if @moving %>
      <%= form_for :dest, url: list_move_path(@list) do |f| %>
        <%= f.label :list_id, "Destination" %>
        <% if @list.parent.nil? %>
          <%= f.collection_select("list_id", current_user.lists_outside(@list), :id, :path) %>
        <% else %>
          <%= f.collection_select("list_id", current_user.lists_outside(@list), :id, :path, prompt: "/") %>
        <% end %>
        <br />
        <%= f.submit "Move", class: "btn btn-default" %>
      <% end %>
    <% end %>
    <% unless @new_list.nil? %>
      <%= form_for @new_list, url: path_to_create_list(@list) do |f| %>
        <%= f.label :name %>
        <%= f.text_field :name %>
		<%= f.label :language_1 %>
		<select name="language1_id" id="language1_id">
			<% Language.all.each do |l|%>
	  		 	<option value=<%=l.id%>> <%= l.name %></option>
	    	<% end %>
		</select>
		<%= f.label :language_2 %>
		<select name="language2_id" id="language2_id">
			<% Language.all.each do |l|%>
	  		 	<option value=<%=l.id%>> <%= l.name %></option>
	    	<% end %>
		</select>
        <br />
        <%= f.submit "Create list here", class: "btn btn-default" %>
      <% end %>
    <% end %>

    <h2>Sublists</h2>
    <% if @lists.empty? %>
      <p>No sublist.</p>
    <% else %>
      <ul>
        <% @lists.each do |list| %>
          <li>
          <%= link_to list.name, list %>
          </li>
        <% end %>
      </ul>
    <% end %>
	
    <% unless @list.nil? %>
      <h2>Words</h2>
      <% if @wordsets.empty? %>
        <p>No word.</p>
      <% else %> 
		<section class="col-md-12 table-responsive">
		  <table class="table table-bordered table-striped table-condensed">
		    <thead>
			  <tr>
			    <th><%= @language1_name %></th>
			    <th><%= @language2_name %></th>
					<th>Asked</th>
					<th>Succeeded</th>
					<th>Success ratio (%)</th>
			  </tr>
			</thead>
		    <tbody>
		      <% @wordsets.each do |w| %>
  	            <tr>
		        	<td><%= Word.find_by(id:w.word1_id).content %></td>
		        	<td><%= Word.find_by(id:w.word2_id).content %></td>
							<td><%= w.asked %></td>
							<td><%= w.success %></td>
							<td><%= w.success_ratio.to_i %></td>
							
	  		    </tr>	
		      <% end %>
		    </tbody>
		  </table>
	    </section>
      <% end %>
	  
	  
	  <%= link_to "Edit list", edit_list_path(@list), class: "btn btn-default btn-lg btn-primary"  %>
		
		<%= link_to "Train", new_train_path(list_id:@list.id), class: "btn btn-default btn-lg btn-primary" %>
    <% end %>
  </div>
	
	<% if false%>
  <% if not @list.nil? and @list.owner == current_user %>
    <div class="col-md-6">
      <h2>New links</h2>
      <p>
      Quickly add new words to this list while ensuring your
      requested link is present.
      If the words or the link doesn't exist, it will be added.
      </p>
      <%= render 'links/new' %>
    </div>
  <% end %>
	<% end %>
</div>
